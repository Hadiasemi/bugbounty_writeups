<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive IDOR Vulnerability Dashboard</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Plotly.js for interactive charts -->
    <script src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .chart-container {
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .chart-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -2px rgb(0 0 0 / 0.1);
        }
    </style>
     <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-gray-50 text-gray-800">

    <div class="container mx-auto p-4 md:p-8">
        <header class="text-center mb-10">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-900">IDOR Vulnerability Analysis</h1>
            <p class="text-lg text-gray-600 mt-2">An interactive overview of IDOR bug bounty write-ups.</p>
        </header>

        <!-- Grid for the charts -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <!-- Chart 1: ID Type -->
            <div class="bg-white p-6 chart-container">
                <div id="chart-id-type" class="w-full h-96"></div>
            </div>

            <!-- Chart 2: IDOR Impact -->
            <div class="bg-white p-6 chart-container">
                <div id="chart-impact" class="w-full h-96"></div>
            </div>

            <!-- Chart 3: Vulnerable Functionality -->
            <div class="bg-white p-6 chart-container">
                <div id="chart-functionality" class="w-full h-96"></div>
            </div>
            
            <!-- Chart 4: Prediction Method -->
            <div class="bg-white p-6 chart-container">
                <div id="chart-prediction" class="w-full h-96"></div>
            </div>

            <!-- Chart 5: Parameter Location -->
            <div class="bg-white p-6 chart-container">
                <div id="chart-location" class="w-full h-96"></div>
            </div>

            <!-- Chart 6: Average Bounty by ID Type (NEW) -->
            <div class="bg-white p-6 chart-container">
                 <div id="chart-avg-bounty" class="w-full h-96"></div>
            </div>
        </div>
    </div>

    <script>
        // Data embedded from your idor_analysis_summary_report.json file
        const analysisData = {
          "basic_statistics": { "total_reports": 467, "total_bounty": 1149035.5, "average_bounty": 2460.461456102784 },
          "distributions": {
            "id_type": { "Decimal shorter than 8 digits": 261, "Decimal 8 or more digits": 146, "unknown": 58, "UUID": 2 },
            "impact": { "Reading Data": 227, "Account Takeover": 178, "unknown": 58, "Deleting Data": 2, "Executing Actions": 2 },
            "functionality": { "Creating/Modifying/Deleting Data": 358, "unknown": 58, "Reading Private Data": 51 },
            "prediction_method": { "Public ID": 302, "unknown": 58, "Integer enumeration / Bruteforce": 53, "Information Disclosure": 42, "Signing Oracle": 12 },
            "parameter_location": { "URL Path": 209, "HTTP Body (JSON/POST)": 149, "unknown": 58, "Cookie": 34, "Query Parameter": 17 }
          }
        };

        // NEW: Data from the uploaded image for the Average Bounty chart
        const avgBountyData = {
            "Decimal 8 or more digits": 6075.65,
            "Name/Email": 4693.33,
            "Hexadecimal 8 or more digits": 4240.06,
            "Hash": 3000.00,
            "Other non-bruteforceable": 2926.86,
            "UUID": 2173.84,
            "Decimal shorter than 8 digits": 1718.71,
            "Other - bruteforceable": 1450.00
        };

        // --- Helper function to process and sort data ---
        function processChartData(dataObject, filterUnknown = true) {
            let data = { ...dataObject };
            if (filterUnknown && data.unknown) {
                delete data.unknown;
            }
            const sortedArray = Object.entries(data).sort(([, a], [, b]) => a - b);
            return {
                labels: sortedArray.map(item => item[0]),
                values: sortedArray.map(item => item[1])
            };
        }

        // --- Plotting Configuration ---
        const commonLayout = {
            margin: { l: 250, r: 20, t: 80, b: 50 },
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            font: { family: 'Inter, sans-serif', color: '#374151' },
            title: { font: { size: 18 } }
        };

        const pieLayout = {
             margin: { l: 20, r: 20, t: 80, b: 20 },
             paper_bgcolor: 'rgba(0,0,0,0)',
             plot_bgcolor: 'rgba(0,0,0,0)',
             font: { family: 'Inter, sans-serif', color: '#374151' },
             title: { font: { size: 18 } },
             legend: { x: 1, y: 0.5, xanchor: 'left' }
        };

        // --- Chart 1: ID Type ---
        const idTypeData = processChartData(analysisData.distributions.id_type);
        Plotly.newPlot('chart-id-type', [{
            x: idTypeData.values,
            y: idTypeData.labels,
            type: 'bar',
            orientation: 'h',
            marker: { color: 'rgba(79, 70, 229, 0.8)' }
        }], { ...commonLayout, title: 'Vulnerable ID Types (by Report Count)' }, {responsive: true});

        // --- Chart 2: IDOR Impact ---
        const impactData = processChartData(analysisData.distributions.impact);
        Plotly.newPlot('chart-impact', [{
            x: impactData.values,
            y: impactData.labels,
            type: 'bar',
            orientation: 'h',
            marker: { color: 'rgba(219, 39, 119, 0.8)' }
        }], { ...commonLayout, title: 'Impact of IDOR' }, {responsive: true});

        // --- Chart 3: Vulnerable Functionality ---
        const funcData = processChartData(analysisData.distributions.functionality);
        Plotly.newPlot('chart-functionality', [{
            x: funcData.values,
            y: funcData.labels,
            type: 'bar',
            orientation: 'h',
            marker: { color: 'rgba(34, 197, 94, 0.8)' }
        }], { ...commonLayout, title: 'Vulnerable Functionality' }, {responsive: true});
        
        // --- Chart 4: Prediction Method ---
        const predData = processChartData(analysisData.distributions.prediction_method);
        Plotly.newPlot('chart-prediction', [{
            x: predData.values,
            y: predData.labels,
            type: 'bar',
            orientation: 'h',
            marker: { color: 'rgba(245, 158, 11, 0.8)' }
        }], { ...commonLayout, title: 'ID Prediction Methods' }, {responsive: true});

        // --- Chart 5: Parameter Location ---
        const locationData = processChartData(analysisData.distributions.parameter_location);
        Plotly.newPlot('chart-location', [{
            values: locationData.values,
            labels: locationData.labels,
            type: 'pie',
            hole: .4,
            textinfo: 'percent+label',
            marker: { colors: ['#6ee7b7', '#fca5a5', '#fdba74', '#bae6fd'] }
        }], { ...pieLayout, title: 'Parameter Location', showlegend: false }, {responsive: true});

        // --- Chart 6: Average Bounty by ID Type (NEW) ---
        const bountyData = processChartData(avgBountyData);
        Plotly.newPlot('chart-avg-bounty', [{
            x: bountyData.values,
            y: bountyData.labels,
            type: 'bar',
            orientation: 'h',
            marker: { color: 'rgba(14, 165, 233, 0.8)' },
            text: bountyData.values.map(v => `$${v.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`),
            textposition: 'inside'
        }], { 
            ...commonLayout, 
            title: 'Average Bounty by ID Type',
            xaxis: { title: 'Average Bounty ($)'}
        }, {responsive: true});
    </script>
</body>
</html>

