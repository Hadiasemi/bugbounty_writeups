<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive RCE Vulnerability Dashboard</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Plotly.js for interactive charts -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .chart-container {
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .chart-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -2px rgb(0 0 0 / 0.1);
        }
    </style>
     <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-gray-50 text-gray-800">

    <div class="container mx-auto p-4 md:p-8">
        <header class="text-center mb-10">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-900">Remote Code Execution (RCE) Vulnerability Analysis</h1>
            <p class="text-lg text-gray-600 mt-2">An interactive overview of RCE bug bounty write-ups.</p>
        </header>

        <!-- Grid for the charts -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <!-- Chart 1: Vulnerability Types -->
            <div id="chart-vuln-types-container" class="bg-white p-6 chart-container">
                <div id="chart-vuln-types" class="w-full h-96"></div>
            </div>

            <!-- Chart 2: Exploited Technologies -->
            <div id="chart-tech-container" class="bg-white p-6 chart-container">
                <div id="chart-tech" class="w-full h-96"></div>
            </div>

            <!-- Chart 3: Vulnerable Functionality -->
            <div id="chart-func-container" class="bg-white p-6 chart-container">
                <div id="chart-func" class="w-full h-96"></div>
            </div>

            <!-- Chart 4: Execution Context -->
            <div id="chart-context-container" class="bg-white p-6 chart-container">
                <div id="chart-context" class="w-full h-96"></div>
            </div>

            <!-- Chart 5: Attack Vectors -->
            <div id="chart-vectors-container" class="bg-white p-6 chart-container">
                <div id="chart-vectors" class="w-full h-96"></div>
            </div>

            <!-- Chart 6: Impact of RCE -->
            <div id="chart-impact-container" class="bg-white p-6 chart-container">
                <div id="chart-impact" class="w-full h-96"></div>
            </div>
        </div>
    </div>

    <script>
        // Data embedded from your rce_analysis_summary_report.json file
        const analysisData = {
          "distributions": {
            "functionality": { "Imports/Sharing": 450, "General Application Logic": 168, "Admin/Config Panel": 156, "unknown": 110, "File Management": 65, "User Profile/Content": 55, "CI/CD Pipeline": 4 },
            "vulnerability_type": { "Command Injection": 685, "Unrestricted File Write/Upload": 115, "unknown": 110, "Insecure Deserialization": 58, "Server-Side Template Injection (SSTI)": 18, "Code Injection": 12, "Log Poisoning": 5, "XXE": 5 },
            "execution_context": { "Server-side RCE": 797, "unknown": 110, "CI/CD Pipeline RCE": 66, "Desktop App RCE": 35 },
            "language_or_framework": { "PHP": 285, "Java": 253, "Generic Linux": 194, "unknown": 110, "Python": 80, ".NET": 46, "NodeJS": 29, "Ruby": 11 },
            "attack_vector": { "Web Application Parameter": 844, "unknown": 110, "API Endpoint": 21, "Third-party Library": 21, "File Upload Feature": 12 },
            "impact": { "Shell/Command Execution": 790, "unknown": 110, "Full System Compromise": 85, "Service Disruption (DoS)": 15, "Data Exfiltration": 7, "Internal Network Pivoting": 1 }
          }
        };

        // --- Helper function to process and sort data ---
        function processChartData(dataObject, filterUnknown = true) {
            let data = { ...dataObject };
            if (filterUnknown && data.unknown) {
                delete data.unknown;
            }
            // Convert to array and sort by value
            const sortedArray = Object.entries(data).sort(([, a], [, b]) => a - b);
            return {
                labels: sortedArray.map(item => item[0]),
                values: sortedArray.map(item => item[1])
            };
        }

        // --- Plotting Configuration ---
        const commonLayout = {
            margin: { l: 250, r: 20, t: 80, b: 50 },
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            font: { family: 'Inter, sans-serif', color: '#374151' },
            title: { font: { size: 18 } }
        };

        const pieLayout = {
             margin: { l: 20, r: 20, t: 80, b: 20 },
             paper_bgcolor: 'rgba(0,0,0,0)',
             plot_bgcolor: 'rgba(0,0,0,0)',
             font: { family: 'Inter, sans-serif', color: '#374151' },
             title: { font: { size: 18 } },
             legend: { x: 1, y: 0.5, xanchor: 'left' }
        };

        // --- Chart 1: Vulnerability Types (Bar Chart) ---
        const vulnData = processChartData(analysisData.distributions.vulnerability_type);
        Plotly.newPlot('chart-vuln-types', [{
            x: vulnData.values,
            y: vulnData.labels,
            type: 'bar',
            orientation: 'h',
            marker: { color: 'rgba(79, 70, 229, 0.8)' }
        }], {
            ...commonLayout,
            title: 'Common RCE Vulnerability Types (Reason)'
        }, {responsive: true});

        // --- Chart 2: Exploited Technologies (Bar Chart) ---
        const techData = processChartData(analysisData.distributions.language_or_framework);
        Plotly.newPlot('chart-tech', [{
            x: techData.values,
            y: techData.labels,
            type: 'bar',
            orientation: 'h',
            marker: { color: 'rgba(34, 197, 94, 0.8)' }
        }], {
            ...commonLayout,
            title: 'Exploited Technologies'
        }, {responsive: true});

        // --- Chart 3: Vulnerable Functionality (Bar Chart) ---
        const funcData = processChartData(analysisData.distributions.functionality);
        Plotly.newPlot('chart-func', [{
            x: funcData.values,
            y: funcData.labels,
            type: 'bar',
            orientation: 'h',
            marker: { color: 'rgba(219, 39, 119, 0.8)' }
        }], {
            ...commonLayout,
            title: 'Vulnerable Application Functionality'
        }, {responsive: true});
        
        // --- Chart 4: Execution Context (Bar Chart) ---
        const contextData = processChartData(analysisData.distributions.execution_context);
        Plotly.newPlot('chart-context', [{
            x: contextData.labels,
            y: contextData.values,
            type: 'bar',
            marker: { color: 'rgba(245, 158, 11, 0.8)' }
        }], {
            ...commonLayout,
            margin: { l: 50, r: 20, t: 80, b: 50 },
            title: 'RCE Execution Context (Type)'
        }, {responsive: true});

        // --- Chart 5: Attack Vectors (Pie Chart) ---
        const vectorData = processChartData(analysisData.distributions.attack_vector);
        // Calculate pull values to explode smaller slices
        const vectorPull = vectorData.values.map(v => (v / Math.max(...vectorData.values)) < 0.1 ? 0.1 : 0);
        Plotly.newPlot('chart-vectors', [{
            values: vectorData.values,
            labels: vectorData.labels,
            type: 'pie',
            hole: .4,
            pull: vectorPull,
            textinfo: 'percent',
            textposition: 'inside',
            marker: { colors: ['#a7f3d0', '#fecaca', '#fde68a', '#d1d5db'] }
        }], {
            ...pieLayout,
            title: 'RCE Attack Vectors'
        }, {responsive: true});

        // --- Chart 6: Impact of RCE (Pie Chart) ---
        const impactData = processChartData(analysisData.distributions.impact);
        const impactPull = impactData.values.map(v => (v / Math.max(...impactData.values)) < 0.1 ? 0.1 : 0);
        Plotly.newPlot('chart-impact', [{
            values: impactData.values,
            labels: impactData.labels,
            type: 'pie',
            hole: .4,
            pull: impactPull,
            textinfo: 'percent',
            textposition: 'inside',
            marker: { colors: ['#6ee7b7', '#fca5a5', '#fdba74', '#bae6fd', '#c4b5fd'] }
        }], {
            ...pieLayout,
            title: 'Impact of RCE (Exploit)'
        }, {responsive: true});

    </script>
</body>
</html>

