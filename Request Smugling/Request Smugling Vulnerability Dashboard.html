<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Request Smuggling Vulnerability Dashboard</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Plotly.js for interactive charts - UPDATED LINK -->
    <script src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .chart-container {
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .chart-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -2px rgb(0 0 0 / 0.1);
        }
        .stat-card h3 {
             border-bottom: 2px solid #e5e7eb;
             padding-bottom: 0.5rem;
             margin-bottom: 1rem;
        }
        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
            border-bottom: 1px solid #f3f4f6;
        }
        .stat-item:last-child {
            border-bottom: none;
        }
        .stat-label {
            font-weight: 500;
            color: #4b5563;
        }
        .stat-value {
            font-weight: 600;
            color: #1f2937;
            font-size: 1.125rem;
        }
    </style>
     <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-gray-50 text-gray-800">

    <div class="container mx-auto p-4 md:p-8">
        <header class="text-center mb-10">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-900">Request Smuggling Vulnerability Analysis</h1>
            <p class="text-lg text-gray-600 mt-2">An interactive overview of Request Smuggling bug bounty write-ups.</p>
        </header>

        <!-- Grid for the charts -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <!-- Chart 1: Smuggling Type -->
            <div class="bg-white p-6 chart-container">
                <div id="chart-type" class="w-full h-96"></div>
            </div>

            <!-- Chart 2: Desync Impact -->
            <div class="bg-white p-6 chart-container">
                <div id="chart-impact" class="w-full h-96"></div>
            </div>

            <!-- Chart 3: Vulnerable Component -->
            <div class="bg-white p-6 chart-container">
                <div id="chart-component" class="w-full h-96"></div>
            </div>

            <!-- Chart 4: Impact Severity -->
            <div class="bg-white p-6 chart-container">
                <div id="chart-severity" class="w-full h-96"></div>
            </div>
        </div>
    </div>

    <script>
        // Data embedded from your smuggling_analysis_summary_report.json file
        const analysisData = {
          "statistics": { "total_reports_analyzed": 41 },
          "distributions": {
            "smuggling_type": { "CL.TE": 27, "HTTP/2 Downgrade": 9, "unknown": 3, "TE.CL": 2 },
            "desync_impact": { "Bypass Security Controls/WAF": 18, "Cache Poisoning/Deception": 7, "Stored XSS": 6, "Account Takeover": 5, "unknown": 3, "Session Hijacking/Request Capture": 1, "Internal SSRF": 1 },
            "vulnerable_component": { "Front-End Proxy (General)": 36, "unknown": 3, "Apache": 1, "Akamai": 1 },
            "impact_severity": { "critical": 32, "high": 5, "unknown": 3, "low": 1 }
          }
        };

        // --- Helper function to process and sort data ---
        function processChartData(dataObject, filterUnknown = true, sort = 'value') {
            let data = { ...dataObject };
            if (filterUnknown && data.unknown) {
                delete data.unknown;
            }
            let sortedArray;
            if (sort === 'value') {
                 sortedArray = Object.entries(data).sort(([, a], [, b]) => a - b);
            } else { // sort by key for severity
                 const severityOrder = { 'low': 1, 'medium': 2, 'high': 3, 'critical': 4 };
                 sortedArray = Object.entries(data).sort(([a], [b]) => severityOrder[a] - severityOrder[b]);
            }
           
            return {
                labels: sortedArray.map(item => item[0]),
                values: sortedArray.map(item => item[1])
            };
        }

        // --- Plotting Configuration ---
        const commonLayout = {
            margin: { l: 200, r: 20, t: 80, b: 50 },
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            font: { family: 'Inter, sans-serif', color: '#374151' },
            title: { font: { size: 18 } }
        };

        const pieLayout = {
             margin: { l: 20, r: 20, t: 80, b: 20 },
             paper_bgcolor: 'rgba(0,0,0,0)',
             plot_bgcolor: 'rgba(0,0,0,0)',
             font: { family: 'Inter, sans-serif', color: '#374151' },
             title: { font: { size: 18 } },
             legend: { x: 1, y: 0.5, xanchor: 'left' }
        };

        // --- Chart 1: Smuggling Type ---
        const typeData = processChartData(analysisData.distributions.smuggling_type);
        Plotly.newPlot('chart-type', [{
            x: typeData.values,
            y: typeData.labels,
            type: 'bar',
            orientation: 'h',
            marker: { color: 'rgba(79, 70, 229, 0.8)' }
        }], { ...commonLayout, title: 'Smuggling Techniques (CL.TE, TE.CL, etc.)' }, {responsive: true});

        // --- Chart 2: Desync Impact ---
        const impactData = processChartData(analysisData.distributions.desync_impact);
        Plotly.newPlot('chart-impact', [{
            x: impactData.values,
            y: impactData.labels,
            type: 'bar',
            orientation: 'h',
            marker: { color: 'rgba(219, 39, 119, 0.8)' }
        }], { ...commonLayout, title: 'Impact of Desynchronization' }, {responsive: true});
        
        // --- Chart 3: Vulnerable Component ---
        const componentData = processChartData(analysisData.distributions.vulnerable_component);
        Plotly.newPlot('chart-component', [{
            x: componentData.values,
            y: componentData.labels,
            type: 'bar',
            orientation: 'h',
            marker: { color: 'rgba(34, 197, 94, 0.8)' }
        }], { ...commonLayout, title: 'Vulnerable Components' }, {responsive: true});

        // --- Chart 4: Impact Severity ---
        const severityData = processChartData(analysisData.distributions.impact_severity, true, 'key');
        Plotly.newPlot('chart-severity', [{
            values: severityData.values,
            labels: severityData.labels,
            type: 'pie',
            hole: .4,
            textinfo: 'percent+label',
            marker: { colors: ['#6ee7b7', '#fca5a5', '#fdba74', '#d946ef'] }
        }], { ...pieLayout, title: 'Impact Severity', showlegend: false }, {responsive: true});

    </script>
</body>
</html>

