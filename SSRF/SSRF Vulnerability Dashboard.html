<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive SSRF Vulnerability Dashboard</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Plotly.js for interactive charts -->
    <script src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .chart-container {
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .chart-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -2px rgb(0 0 0 / 0.1);
        }
        .stat-card h3 {
             border-bottom: 2px solid #e5e7eb;
             padding-bottom: 0.5rem;
             margin-bottom: 1rem;
        }
        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
            border-bottom: 1px solid #f3f4f6;
        }
        .stat-item:last-child {
            border-bottom: none;
        }
        .stat-label {
            font-weight: 500;
            color: #4b5563;
        }
        .stat-value {
            font-weight: 600;
            color: #1f2937;
            font-size: 1.125rem;
        }
    </style>
     <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-gray-50 text-gray-800">

    <div class="container mx-auto p-4 md:p-8">
        <header class="text-center mb-10">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-900">SSRF Vulnerability Analysis</h1>
            <p class="text-lg text-gray-600 mt-2">An interactive overview of SSRF bug bounty write-ups.</p>
        </header>

        <!-- Grid for the charts -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <!-- Chart 1: Vulnerable Functionality -->
            <div class="bg-white p-6 chart-container">
                <div id="chart-func" class="w-full h-96"></div>
            </div>

            <!-- Chart 2: SSRF Impact -->
            <div class="bg-white p-6 chart-container">
                <div id="chart-impact" class="w-full h-96"></div>
            </div>

            <!-- Chart 3: Bypass Methods -->
            <div class="bg-white p-6 chart-container">
                <div id="chart-bypass" class="w-full h-96"></div>
            </div>

            <!-- Chart 4: Impact Severity -->
            <div class="bg-white p-6 chart-container">
                <div id="chart-severity" class="w-full h-96"></div>
            </div>

            <!-- Chart 5: Read Capabilities -->
            <div class="bg-white p-6 chart-container">
                <div id="chart-read" class="w-full h-96"></div>
            </div>

            <!-- Card 6: Key Statistics -->
            <div class="bg-white p-6 chart-container stat-card">
                 <h3 class="text-lg font-bold text-center text-gray-900">Key Statistics</h3>
                 <div id="stats-container" class="mt-4"></div>
            </div>
        </div>
    </div>

    <script>
        // Data embedded from your ssrf_advanced_analysis_report.json file
        const analysisData = {
          "basic_statistics": { "total_reports": 298, "total_bounty": 864442.2, "average_bounty": 2900.81, "median_bounty": 0.0, "max_bounty": 288500.0, "min_bounty": 0.0 },
          "distributions": {
            "functionality_distribution": { "import by url": 114, "cloud services": 38, "pdf generation": 29, "unknown": 29, "file upload": 28, "email/notification": 17, "image processing": 11, "proxy/redirect": 9, "monitoring": 8, "webhook": 4, "feed reader": 4, "url preview": 3, "api integration": 2, "oauth/auth": 2 },
            "impact_distribution": { "rce": 98, "credential theft": 84, "unknown": 25, "configuration exposure": 23, "cloud metadata": 15, "information disclosure": 14, "internal network access": 12, "protocol exploitation": 7, "container escape": 6, "database access": 5, "service disruption": 4, "data exfiltration": 4, "file system access": 1 },
            "impact_severity_distribution": { "critical": 206, "high": 41, "unknown": 25, "medium": 22, "low": 4 },
            "bypass_methods": { "redirect": 119, "ip bypass": 80, "url encoding": 49, "protocol bypass": 16, "domain bypass": 10, "no address bypass necessary": 9, "dns rebinding": 6, "http smuggling": 4, "unicode bypass": 3, "parser differential": 2 },
            "read_capabilities": { "full-read": 161, "blind": 95, "unknown": 25, "partial-read": 17 }
          }
        };

        // --- Helper function to process and sort data ---
        function processChartData(dataObject, filterUnknown = true) {
            let data = { ...dataObject };
            if (filterUnknown && data.unknown) {
                delete data.unknown;
            }
            const sortedArray = Object.entries(data).sort(([, a], [, b]) => a - b);
            return {
                labels: sortedArray.map(item => item[0]),
                values: sortedArray.map(item => item[1])
            };
        }

        // --- Plotting Configuration ---
        const commonLayout = {
            margin: { l: 200, r: 20, t: 80, b: 50 },
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            font: { family: 'Inter, sans-serif', color: '#374151' },
            title: { font: { size: 18 } }
        };

        const pieLayout = {
             margin: { l: 20, r: 20, t: 80, b: 20 },
             paper_bgcolor: 'rgba(0,0,0,0)',
             plot_bgcolor: 'rgba(0,0,0,0)',
             font: { family: 'Inter, sans-serif', color: '#374151' },
             title: { font: { size: 18 } },
             legend: { x: 1, y: 0.5, xanchor: 'left' }
        };

        // --- Chart 1: Vulnerable Functionality ---
        const funcData = processChartData(analysisData.distributions.functionality_distribution);
        Plotly.newPlot('chart-func', [{
            x: funcData.values,
            y: funcData.labels,
            type: 'bar',
            orientation: 'h',
            marker: { color: 'rgba(79, 70, 229, 0.8)' }
        }], { ...commonLayout, title: 'Vulnerable Functionality' }, {responsive: true});

        // --- Chart 2: SSRF Impact ---
        const impactData = processChartData(analysisData.distributions.impact_distribution);
        Plotly.newPlot('chart-impact', [{
            values: impactData.values,
            labels: impactData.labels,
            type: 'pie',
            hole: .4,
            textinfo: 'percent',
            marker: { colors: ['#6ee7b7', '#fca5a5', '#fdba74', '#bae6fd', '#c4b5fd', '#a7f3d0', '#fecaca'] }
        }], { ...pieLayout, title: 'SSRF Impact Distribution', showlegend: false }, {responsive: true});

        // --- Chart 3: Bypass Methods ---
        const bypassData = processChartData(analysisData.distributions.bypass_methods);
        Plotly.newPlot('chart-bypass', [{
            x: bypassData.values,
            y: bypassData.labels,
            type: 'bar',
            orientation: 'h',
            marker: { color: 'rgba(219, 39, 119, 0.8)' }
        }], { ...commonLayout, title: 'SSRF Bypass Methods' }, {responsive: true});
        
        // --- Chart 4: Impact Severity ---
        const severityData = processChartData(analysisData.distributions.impact_severity_distribution);
        Plotly.newPlot('chart-severity', [{
            values: severityData.values,
            labels: severityData.labels,
            type: 'pie',
            hole: .4,
            textinfo: 'percent',
            marker: { colors: ['#d946ef', '#fca5a5', '#fdba74', '#86efac'] }
        }], { ...pieLayout, title: 'Impact Severity', showlegend: false }, {responsive: true});

        // --- Chart 5: Read Capabilities ---
        const readData = processChartData(analysisData.distributions.read_capabilities);
        Plotly.newPlot('chart-read', [{
            x: readData.labels,
            y: readData.values,
            type: 'bar',
            marker: { color: 'rgba(245, 158, 11, 0.8)' }
        }], { 
            ...commonLayout, 
            margin: { l: 50, r: 20, t: 80, b: 50 },
            title: 'Read Capabilities' 
        }, {responsive: true});

        // --- Card 6: Key Statistics ---
        const stats = analysisData.basic_statistics;
        const statsContainer = document.getElementById('stats-container');
        statsContainer.innerHTML = `
            <div class="stat-item">
                <span class="stat-label">Total Reports Analyzed</span>
                <span class="stat-value">${stats.total_reports}</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Total Bounty Paid</span>
                <span class="stat-value">$${stats.total_bounty.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Average Bounty</span>
                <span class="stat-value">$${stats.average_bounty.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Highest Bounty</span>
                <span class="stat-value">$${stats.max_bounty.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</span>
            </div>
        `;

    </script>
</body>
</html>

